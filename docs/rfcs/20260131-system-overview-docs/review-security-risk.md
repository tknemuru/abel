## Security & Risk Reviewer によるレビュー結果

### 1. 判定 (Decision)

- **Status**: Approve

**判定基準:** P0 が1件以上存在する場合は Request Changes とする。P0 が0件の場合は Approve とする。

本 RFC はドキュメントの再編・統合のみを対象としており、コード変更を伴わない。設計レベルでのセキュリティ脆弱性の導入リスクは存在しない。移行リスクおよび後方互換性に関しても、RFC 内で検討されており重大な見落としは認められない。P0 該当なし。

### 2. 良い点 (Strengths)

- **7. 横断的関心事**: 本 RFC がコード変更を伴わないことを明示し、セキュリティ・スケーラビリティ・可観測性への影響がないことを宣言している。ドキュメントのみの変更であることのリスク特性を正しく認識している。

- **7.4 マイグレーションと後方互換性**: `spec.md` および `arch.md` 削除に伴うリンク切れリスクを事前に識別し、既知のリンク（`arch.md` 内の `learning-data-contract.md` への相対リンク）を列挙している。また `ops.md` 内に `spec.md` / `arch.md` への参照がないことを確認済みと明記しており、影響調査が実施されている。

- **6. 代替案の検討（案B の選定）**: `learning-data-contract.md` を統合対象外として維持する判断は、セキュリティ観点からも妥当である。契約書としての独立性を維持することで、abel-learning との連携における仕様のトレーサビリティが保たれ、仕様齟齬に起因する障害リスクが軽減される。

- **5.1 マッピング表**: 移行元と移行先を全セクション網羅的に定義しており、移行時の情報喪失リスクを最小化する設計となっている。

### 3. 指摘事項 (Issues)

#### Severity 定義

| Severity | 定義 |
| :--- | :--- |
| **P0 (Blocker)** | 修正必須。論理的欠陥、仕様漏れ、重大なリスク、回答必須の質問 |
| **P1 (Nit)** | 提案。より良い手法、軽微な懸念、参考情報 |

#### 指摘一覧

P0: 該当なし

**[P1-1] 既存ドキュメント内の認証情報・機密情報の移行時における取り扱い方針が未記載**
- **対象セクション**: 5.1 既存ドキュメントと新ドキュメントの対応関係、5.2 新ドキュメントの構成
- **内容**: 既存の `spec.md` および `arch.md` には、外部サービスとの接続方式（IPAT のブラウザ自動操作、SMTP 認証、Jupyter トークン等）に関する記述が含まれている。新ドキュメントへの移行時に、設定キー名の記載レベルに留めるか、認証フローの詳細まで記述するかの方針が明示されていない。現状の既存ドキュメントは設定キー名と接続方式の概要レベルに留まっており機密情報そのものは含まれていないが、`api-overview.md` の「外部サービス連携」セクションで認証方式を整理する際に、実装の詳細（認証シーケンス、トークンの取得方法等）を過度に記載すると、攻撃者にとっての情報源となる可能性がある。
- **修正の期待値**: 実装時に、新ドキュメントにおける認証関連情報の記載粒度を「接続方式の概要 + 設定キー名への参照」に留めることを意識する程度でよい。現状の既存ドキュメントの記載レベルをそのまま踏襲すれば問題は生じない。

**[P1-2] 削除対象ファイルの Git 履歴からの情報復元リスクに関する認識**
- **対象セクション**: 5.3 ファイル操作の実行順序、9. 実装・リリース計画
- **内容**: `spec.md` と `arch.md` を削除する計画であるが、Git リポジトリの履歴には削除前の内容が残存する。これ自体はセキュリティリスクではない（既存ドキュメントに機密情報は含まれていないことを確認済み）。ただし、削除後に「過去のドキュメントを参照したい」というニーズが生じた場合の復元手段として Git 履歴が利用可能であることを、テスト戦略または実装計画に明記しておくと、情報喪失に対する懸念を払拭できる。
- **修正の期待値**: 実装計画または検証方法に「削除されたドキュメントは Git 履歴から復元可能であるため、不可逆な情報喪失は発生しない」旨の一文を追記することを推奨する。必須ではない。

**[P1-3] 外部（GitHub 上のリンク・Issue・PR）からの `spec.md` / `arch.md` 参照の調査範囲**
- **対象セクション**: 7.4 マイグレーションと後方互換性
- **内容**: RFC では `ops.md` 内に `spec.md` / `arch.md` への参照がないことを確認済みと記載しているが、調査範囲がリポジトリ内のファイルに限定されている。GitHub 上の Issue、Pull Request、Wiki、あるいは別リポジトリ（abel-learning 等）から `docs/spec.md` や `docs/arch.md` へのパーマリンクで参照されている場合、削除によりリンク切れが発生する。リポジトリ内の grep 検索では `spec.md` / `arch.md` への参照が `docs/` 配下と RFC ディレクトリのみに限られることを確認したが、外部参照については調査されていない。
- **修正の期待値**: 実装時に、GitHub 上の Issue / PR 内で `docs/spec.md` や `docs/arch.md` への参照が存在しないか簡易的に確認することを推奨する（`gh search` 等）。仮にリンク切れが発生しても影響は軽微（過去のドキュメント参照が 404 になる程度）であるため、ブロッカーではない。

**[P1-4] 移行作業の原子性（アトミック性）に関する考慮**
- **対象セクション**: 5.3 ファイル操作の実行順序、9. 実装・リリース計画
- **内容**: 実行順序は「新ドキュメント3件作成 → 旧ドキュメント2件削除」の5ステップで定義されている。この順序自体は妥当であるが、万一移行作業が途中で中断された場合（例: ステップ3完了後にステップ4未実行）、新旧ドキュメントが並存する状態が一時的に生じる。この状態では「どちらが SoT か」が不明確になり、代替案 案C で指摘された短所と同じ問題が発生する。ドキュメントのみの変更であるため実害は限定的であるが、全5ステップを単一コミットとして実行することで、中間状態がリポジトリに残らないようにすることが望ましい。
- **修正の期待値**: 5.3 または 9. に「全ステップを単一コミットとして実行し、新旧ドキュメントの並存状態をリポジトリ履歴に残さない」旨を明記することを推奨する。あるいは、新ドキュメント作成を1コミット、旧ドキュメント削除を別コミットとする場合でも、同一 PR 内でマージすることでメインブランチ上の中間状態を回避できる。
